# =============================================================================
# HACKATHON CONFIG
# =============================================================================
# Instructions: HACKATHON-README.md
# Processor Reference: CHEAT-SHEET.md
#
# After ANY change: make restart service=otel-collector
# Then wait 1-2 minutes for data to appear in Coralogix
# =============================================================================

exporters:
  coralogix:
    domain: "${CX_DOMAIN}"
    private_key: "${CX_API_KEY}"
    application_name: "otel-hackathon"
    subsystem_name: "${TEAM_NAME}"
    timeout: 30s

processors:
  # ===========================================================================
  # PASTE YOUR CHALLENGE PROCESSORS HERE
  # ===========================================================================
  # Copy processor configs from CHEAT-SHEET.md
  # ===========================================================================

connectors:
  spanmetrics:
    dimensions:
      - name: http.method
      - name: http.status_code
      - name: http.route
      - name: service.name
    histogram:
      explicit:
        buckets: [10ms, 50ms, 100ms, 250ms, 500ms, 1s, 2s, 5s, 10s]
    exemplars:
      enabled: true

service:
  pipelines:
    traces:
      receivers: [otlp]
      # Add your processors before 'batch'
      processors:
        [
          resourcedetection,
          memory_limiter,
          transform,
          transform/inject-pii,
          batch,
        ]
      exporters: [coralogix, otlp, debug, spanmetrics]

    metrics:
      receivers:
        [
          docker_stats,
          httpcheck/frontend-proxy,
          hostmetrics,
          nginx,
          otlp,
          postgresql,
          redis,
          spanmetrics,
        ]
      processors: [resourcedetection, memory_limiter, batch]
      exporters: [coralogix, otlphttp/prometheus, debug]

    logs:
      receivers: [otlp]
      processors: [resourcedetection, memory_limiter, batch]
      exporters: [coralogix, opensearch, debug]
